<!DOCTYPE html>
<html lang="en">
<head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-FF7911YWVR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-FF7911YWVR');
</script>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Matheus Fagundes</title>
<meta name="description" content="Portfolio of Matheus Fagundes — STEM MBA, Data Strategist & Engineer." />
<style>
:root{
  --bg:#ffffff; --fg:#111; --muted:#e9e9e9; --soft:#f7f7f7; --link:#111;
  --dim:.28; --ring:38px; --dot:6px; --card-radius:14px;
}
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%}
body{
  background:var(--bg); color:var(--fg);
  font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
  -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
  overflow:hidden;
}
a{color:var(--link);text-decoration:none}
a:focus-visible,button:focus-visible{outline:2px dashed #999;outline-offset:4px}
.container{max-width:1320px;margin:0 auto;padding:0 24px}
.row{display:flex;align-items:center;justify-content:space-between;gap:16px}
header{
  position:fixed;top:0;left:0;right:0;z-index:20;
  background:rgba(255,255,255,.96);border-bottom:1px solid var(--muted);
  backdrop-filter:saturate(180%) blur(8px);-webkit-backdrop-filter:saturate(180%) blur(8px);
}
.tabs{display:flex;gap:28px;align-items:center;padding:14px 0}
.tabs a{
  font-size:13px;font-weight:700;letter-spacing:.04em;
  opacity:var(--dim);filter:grayscale(1);
  transition:opacity .18s ease,filter .18s ease;
}
.tabs a:hover,.tabs a:focus,.tabs a.active{opacity:1;filter:none}
.meta{display:flex;gap:18px;align-items:center;font-size:11px;opacity:.7}
.scroller{
  position:fixed;top:0;left:0;right:0;bottom:0;
  overflow-y:auto;scroll-snap-type:y mandatory;
}
section.panel{
  min-height:100vh;scroll-snap-align:start;
  display:grid;place-items:center;
  padding:64px 0 44px;position:relative;
}
.stage .frame{
  width:min(68vw,480px);aspect-ratio:3/4;background:#000;
  display:grid;place-items:center;overflow:hidden;
  box-shadow:0 10px 40px rgba(0,0,0,.12);position:relative;border-radius:4px;
}
.stage .frame img{
  max-width:100%;max-height:100%;width:auto;height:auto;
  object-fit:contain;display:block;
}
.overlay-title{
  position:absolute;top:0;left:0;right:0;
  display:flex;justify-content:center;align-items:flex-start;
  padding:14px 16px;pointer-events:none;
  background:linear-gradient(to bottom,rgba(0,0,0,.55),rgba(0,0,0,0));
}
.overlay-title h1{
  margin:0;color:#fff;font-weight:700;
  letter-spacing:.35em;text-transform:uppercase;
  font-size:clamp(14px,2.2vw,22px);text-align:center;
}
.panel.alt{background:var(--soft)}
.timeline{
  --line:#e6e7eb;max-width:1100px;width:100%;
  margin:0 auto;padding:24px 10px;position:relative;
}
.timeline::before{
  content:"";position:absolute;top:0;bottom:0;
  left:50%;width:3px;background:var(--line);transform:translateX(-50%);
}
.timeline ol{list-style:none}
.timeline li{
  position:relative;margin:36px 0;
  opacity:0;transform:translateY(18px);
  transition:transform .5s ease,opacity .5s ease;
}
.timeline li.in-view{opacity:1;transform:none}
.timeline li::before{content:none!important}
.tl-card{
  position:relative;background:#fff;border:1px solid var(--line);
  border-radius:var(--card-radius);padding:16px 18px;
  box-shadow:0 8px 24px rgba(0,0,0,.05);width:calc(50% - 48px);
  cursor:pointer;transition:transform .18s ease,box-shadow .18s ease;
  outline:none;z-index:1;
}
.timeline li:nth-child(odd) .tl-card{margin-left:calc(50% + 48px)}
.timeline li:nth-child(even) .tl-card{margin-right:calc(50% + 48px)}
.tl-card:hover,.tl-card:focus-within,.tl-card.is-expanded{
  transform:scale(1.03);box-shadow:0 14px 36px rgba(0,0,0,.12);z-index:3;
}
.tl-card:focus-visible{outline:2px dashed #9aa1a8;outline-offset:4px}
.tl-card time{display:block;font-size:12px;letter-spacing:.08em;color:#666;margin-bottom:6px}
.tl-card h3{margin:.1rem 0 .35rem;font-size:18px;letter-spacing:.02em}
.tl-card p{color:#444}
.tl-card .details{
  margin-top:10px;max-height:0;opacity:0;overflow:hidden;
  transition:max-height .3s ease,opacity .2s ease;
}
.tl-card:hover .details,
.tl-card:focus-within .details,
.tl-card.is-expanded .details{max-height:480px;opacity:1}
.tl-card .details ul{padding:0 0 0 18px}
.tl-card .details li{margin:6px 0;line-height:1.45}
.tl-card.work{background:#f5f6f7;border-color:#e3e7ec}
.tl-card.edu{background:#ffe9ec;border-color:#ffcfd6}
.tl-card.work::after,.tl-card.edu::after{
  content:"";position:absolute;left:-6px;top:14px;bottom:14px;
  width:4px;border-radius:2px;
}
.tl-card.work::after{background:#cfd6de}
.tl-card.edu::after{background:#ffb5bf}
@media(max-width:760px){
  .timeline::before{left:20px}
  .tl-card{width:auto;margin-left:44px;margin-right:0}
  .timeline li:nth-child(odd) .tl-card,
  .timeline li:nth-child(even) .tl-card{margin-left:44px;margin-right:0}
}
#s3{background:var(--bg)}
.projects-wrap{max-width:1100px;width:100%;margin:0 auto;padding:0 20px}
.projects-wrap h2{
  font-size:clamp(22px,3vw,32px);letter-spacing:.05em;
  margin-bottom:32px;text-align:center;
}
.proj-card{
  border:1px solid var(--muted);background:#fff;
  border-radius:var(--card-radius);overflow:hidden;
  box-shadow:0 8px 28px rgba(0,0,0,.06);
  transition:box-shadow .2s ease,transform .2s ease;
}
.proj-card:hover{box-shadow:0 18px 48px rgba(0,0,0,.12);transform:translateY(-3px)}
.proj-thumb{
  width:100%;aspect-ratio:16/9;overflow:hidden;
  background:#1e1e2e;display:block;position:relative;
}
.proj-thumb img{
  width:100%;height:100%;object-fit:cover;object-position:top;
  display:block;transition:transform .4s ease;
}
.proj-card:hover .proj-thumb img{transform:scale(1.03)}
.proj-thumb-link{display:block;text-decoration:none}
.proj-body{padding:24px 28px 28px}
.proj-body h3{font-size:20px;letter-spacing:.03em;margin-bottom:6px}
.proj-body .proj-desc{color:#555;line-height:1.65;margin-bottom:18px;font-size:15px}
.proj-tag{
  display:inline-block;font-size:11px;font-weight:700;
  letter-spacing:.06em;text-transform:uppercase;
  background:var(--soft);border:1px solid var(--muted);
  border-radius:4px;padding:3px 8px;margin:0 4px 6px 0;color:#555;
}
.workflow{margin-top:20px;padding-top:18px;border-top:1px solid var(--muted)}
.workflow p.wf-label{
  font-size:11px;font-weight:700;letter-spacing:.1em;
  text-transform:uppercase;color:#999;margin-bottom:12px;
}
.wf-steps{display:flex;flex-wrap:wrap;align-items:center;gap:6px}
.wf-step{
  background:#f0f0f0;border-radius:6px;
  padding:6px 12px;font-size:13px;font-weight:600;color:#333;white-space:nowrap;
}
.wf-arrow{color:#bbb;font-size:16px;font-weight:300}
.proj-thought{
  margin-top:18px;padding:14px 18px;
  background:var(--soft);border-left:3px solid #ccc;
  border-radius:0 8px 8px 0;
  font-size:13px;color:#555;line-height:1.6;font-style:italic;
}
.proj-thought strong{font-style:normal;color:#333}
.proj-cta{
  display:inline-flex;align-items:center;gap:6px;margin-top:18px;
  font-size:13px;font-weight:700;letter-spacing:.04em;text-transform:uppercase;
  border-bottom:2px solid #111;padding-bottom:2px;transition:opacity .15s;
}
.proj-cta:hover{opacity:.6}
.left-dots{
  position:fixed;left:18px;top:50%;transform:translateY(-50%);
  display:flex;flex-direction:column;gap:10px;z-index:30;
}
.left-dots button{
  width:10px;height:10px;border-radius:50%;border:none;padding:0;
  background:#cfcfcf;opacity:.9;cursor:pointer;
  transition:transform .15s ease,background .15s ease;
}
.left-dots button[aria-current="true"]{background:#000;transform:scale(1.2)}
.left-dots button:hover{background:#111}
footer{position:fixed;left:18px;bottom:16px;font-size:11px;opacity:.7;z-index:10}
.sound{
  position:fixed;right:28px;bottom:16px;z-index:10;
  min-width:230px;max-width:min(86vw,340px);
  padding:10px 12px;border-radius:10px;
  border:1px solid var(--muted);background:rgba(255,255,255,.92);
  backdrop-filter:blur(6px);-webkit-backdrop-filter:blur(6px);
}
.spotify-row{
  display:flex;align-items:center;justify-content:space-between;
  gap:12px;margin-bottom:7px;
}
.spotify-label{
  font-size:10px;letter-spacing:.1em;text-transform:uppercase;
  color:#666;font-weight:700;
}
.spotify-btn{
  border:1px solid #d6d6d6;background:#fff;color:#111;
  border-radius:999px;padding:5px 10px;
  font-size:10px;font-weight:700;letter-spacing:.04em;text-transform:uppercase;
  cursor:pointer;
}
.spotify-btn:hover{background:#111;color:#fff;border-color:#111}
.spotify-status{
  font-size:12px;line-height:1.35;color:#333;
  white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
}
.spotify-status.is-error{color:#9c2e2e}
@media(pointer:fine){
  body{cursor:none}
  .cursor-dot,.cursor-ring{
    position:fixed;top:0;left:0;pointer-events:none;z-index:9999;
    transform:translate(-50%,-50%);mix-blend-mode:difference;
  }
  .cursor-dot{width:var(--dot);height:var(--dot);border-radius:50%;background:#fff}
  .cursor-ring{
    width:var(--ring);height:var(--ring);border-radius:50%;
    border:1.8px solid #fff;opacity:.75;
    transition:transform .12s ease,opacity .2s ease;
  }
  .cursor-ring.-hover{transform:translate(-50%,-50%) scale(1.35)}
}
@media(max-width:760px){
  .tabs{gap:14px}
  .tabs a{font-size:11px;letter-spacing:.03em}
  .meta{display:none}
  .left-dots{display:none}
  .sound{right:16px;bottom:12px;min-width:210px;padding:9px 10px}
  .spotify-status{font-size:11px}
  footer{font-size:10px}
  .stage .frame{width:min(88vw,420px);aspect-ratio:3/4}
  .overlay-title h1{font-size:clamp(12px,5vw,18px);letter-spacing:.2em}
  .projects-wrap{padding:0 14px}
  .proj-body{padding:18px 18px 22px}
  .wf-steps{gap:4px}
  .wf-step{font-size:12px;padding:5px 9px}
}
@media(max-width:400px){
  .tabs{gap:10px}
  .tabs a{font-size:10px}
  .stage .frame{width:92vw}
}
</style>
</head>
<body>
<header>
  <div class="container row">
    <nav class="tabs" aria-label="Primary">
      <a href="#s1" data-section="s1">HOME</a>
      <a href="#s2" data-section="s2">INFO</a>
      <a href="#s3" data-section="s3">PROJECTS</a>
    </nav>
    <div class="meta" aria-label="Location and time">
      <span id="temp">--&#176;F</span>
      <span id="city">COLUMBUS</span>
      <span id="clock">--:-- --</span>
    </div>
  </div>
</header>
<div class="scroller" id="scroller">
  <section id="s1" class="panel stage" aria-label="Hero">
    <figure class="frame">
      <img src="img/Headshot.png" alt="Matheus Fagundes headshot" />
      <div class="overlay-title"><h1>Matheus Fagundes</h1></div>
    </figure>
  </section>
  <section id="s2" class="panel alt" aria-label="Experience and Education">
    <div class="timeline" id="timeline">
      <ol>
        <li>
          <div class="tl-card work" role="button" tabindex="0" aria-expanded="false">
            <time>Jun&#8211;Aug 2025</time>
            <h3>JPMorgan Chase &#8212; Strategy Consulting Intern</h3>
            <div class="details"><ul>
              <li>Built project charter &amp; governance cadence across Connected Commerce.</li>
              <li>Defined KPI baseline; ran pilot + parallel run to de-risk cutover.</li>
              <li>Aligned senior leaders on roadmap; supported DS recruiting analytics.</li>
            </ul></div>
          </div>
        </li>
        <li>
          <div class="tl-card work" role="button" tabindex="0" aria-expanded="false">
            <time>Jan&#8211;Apr 2025</time>
            <h3>DLZ &#8212; Internal Consultant</h3>
            <div class="details"><ul>
              <li>Built NPV/IRR scenarios; pressure-tested assumptions with Finance/Ops.</li>
              <li>Summarized risks/mitigations; set decision criteria and checkpoints.</li>
            </ul></div>
          </div>
        </li>
        <li>
          <div class="tl-card work" role="button" tabindex="0" aria-expanded="false">
            <time>Jun 2023&#8211;Jul 2024</time>
            <h3>Rutgers University &#8212; Data Engineer</h3>
            <div class="details"><ul>
              <li>Led 12-person migration; engineered AWS ingestion &amp; processing.</li>
              <li>Improved processing efficiency ~95%; mentored Python analytics.</li>
            </ul></div>
          </div>
        </li>
        <li>
          <div class="tl-card work" role="button" tabindex="0" aria-expanded="false">
            <time>May&#8211;Aug 2022</time>
            <h3>Michael Baker International &#8212; Environmental Eng. Consultant</h3>
            <div class="details"><ul>
              <li>Automated data collection/cleansing for large spatial datasets.</li>
              <li>Established QA steps achieving &gt;95% data integrity.</li>
            </ul></div>
          </div>
        </li>
        <li>
          <div class="tl-card work" role="button" tabindex="0" aria-expanded="false">
            <time>Jan 2021&#8211;Jun 2023</time>
            <h3>University of Georgia &#8212; Data Scientist</h3>
            <div class="details"><ul>
              <li>Built ML forecasting (R&#178; &#8776; 0.97) and physics-based risk models.</li>
              <li>Python/SQL pipelines increased usage ~5&#215; in a $10M consortium.</li>
            </ul></div>
          </div>
        </li>
        <li>
          <div class="tl-card edu" role="button" tabindex="0" aria-expanded="false">
            <time>2024&#8211;2026</time>
            <h3>Ohio State &#8212; STEM MBA</h3>
            <p>Fisher College of Business, Columbus, OH.</p>
            <div class="details"><ul>
              <li>Data &amp; Strategy focus; FIGSA leadership; ACG Cup (M&amp;A) bracket 2nd.</li>
              <li>Projects in KPI design, dashboarding, and DCF modeling.</li>
            </ul></div>
          </div>
        </li>
        <li>
          <div class="tl-card edu" role="button" tabindex="0" aria-expanded="false">
            <time>2019&#8211;2021</time>
            <h3>University of Georgia &#8212; PhD in Engineering</h3>
            <p>Athens, GA.</p>
            <div class="details"><ul>
              <li>Computational &amp; data-driven research in engineering systems.</li>
            </ul></div>
          </div>
        </li>
        <li>
          <div class="tl-card work" role="button" tabindex="0" aria-expanded="false">
            <time>Mar 2021&#8211;May 2023</time>
            <h3>PATH Volleyball &#8212; Head Coach</h3>
            <p>Player development; program improvement ~40% over two seasons.</p>
            <div class="details"><ul>
              <li>Individualized training plans; culture &amp; teamwork emphasis.</li>
              <li>Game strategy, analytics, and feedback loops for athletes.</li>
            </ul></div>
          </div>
        </li>
      </ol>
    </div>
  </section>
  <section id="s3" class="panel" aria-label="Projects">
    <div class="projects-wrap">
      <h2>PROJECTS</h2>
      <div class="proj-card">
        <a class="proj-thumb-link" href="https://scl-alpha-eu8jkmvpxsokpnzpttfyt2.streamlit.app/model_lab" target="_blank" rel="noopener" aria-label="Open Model Lab app">
          <div class="proj-thumb">
            <img src="img/modellab_screenshot.png" alt="Model Lab Streamlit app" onerror="this.parentElement.style.background='#1e1e2e';this.style.display='none'" />
          </div>
        </a>
        <div class="proj-body">
          <h3>Quantitative Trading &#8212; Model Lab</h3>
          <p class="proj-desc">An interactive research platform for building, tuning, and backtesting machine-learning-driven trading strategies. Supports Ridge, Random Forest, and XGBoost; dial long positions, train window, retrain frequency, trading cost, and slippage &#8212; outputs a live sandbox P&amp;L curve.</p>
          <span class="proj-tag">Python</span>
          <span class="proj-tag">Streamlit</span>
          <span class="proj-tag">Scikit-learn</span>
          <span class="proj-tag">XGBoost</span>
          <span class="proj-tag">Quant Finance</span>
          <div class="workflow">
            <p class="wf-label">How it was built</p>
            <div class="wf-steps">
              <span class="wf-step">&#x1F4A1; Brainstorming</span>
              <span class="wf-arrow">&#8594;</span>
              <span class="wf-step">&#x1F916; LLM Suite for Code</span>
              <span class="wf-arrow">&#8594;</span>
              <span class="wf-step">&#x1F4CA; Streamlit UI</span>
              <span class="wf-arrow">&#8594;</span>
              <span class="wf-step">&#x2728; Codex Refinement</span>
              <span class="wf-arrow">&#8594;</span>
              <span class="wf-step">&#x1F4B9; Sandbox Quant Output</span>
            </div>
          </div>
          <div class="proj-thought">
            <strong>My thinking:</strong> I started with a rough idea &#8212; what if I could rapidly compare ML models on financial data without rewriting boilerplate each time? I used an LLM suite to scaffold the core engine fast, then Streamlit to wire up a clean interactive front-end. Codex helped sharpen the backtesting logic and handle edge cases. The result is a sandbox where I can stress-test strategies with realistic trading costs before committing any real capital.
          </div>
          <a class="proj-cta" href="https://scl-alpha-eu8jkmvpxsokpnzpttfyt2.streamlit.app/model_lab" target="_blank" rel="noopener">Launch App &#x2197;</a>
        </div>
      </div>
    </div>
  </section>
</div>
<nav class="left-dots" aria-label="Section navigation">
  <button type="button" data-target="#s1" aria-label="Go to Home" aria-current="true"></button>
  <button type="button" data-target="#s2" aria-label="Go to Info"></button>
  <button type="button" data-target="#s3" aria-label="Go to Projects"></button>
</nav>
<footer>&copy; <span id="year"></span></footer>
<div class="sound" aria-live="polite">
  <div class="spotify-row">
    <span class="spotify-label">Spotify</span>
    <button type="button" class="spotify-btn" id="spotifyConnectBtn">Connect</button>
  </div>
  <div class="spotify-status" id="spotifyNowPlaying">Set client ID to enable.</div>
</div>

<div class="cursor-dot" id="cDot" aria-hidden="true"></div>
<div class="cursor-ring" id="cRing" aria-hidden="true"></div>
<script>
document.getElementById('year').textContent = new Date().getFullYear();
document.addEventListener('DOMContentLoaded', function() {
  var TZ = 'America/New_York', LAT = 39.9612, LON = -82.9988;
  var cityEl = document.getElementById('city');
  var tempEl = document.getElementById('temp');
  var clockEl = document.getElementById('clock');
  if (cityEl) cityEl.textContent = 'COLUMBUS';
  function updateClock() {
    if (!clockEl) return;
    clockEl.textContent = new Intl.DateTimeFormat('en-US', {
      hour: '2-digit', minute: '2-digit', hour12: true, timeZone: TZ
    }).format(new Date());
  }
  updateClock();
  setInterval(updateClock, 1000);
  function updateWeather() {
    var url = 'https://api.open-meteo.com/v1/forecast?latitude=' + LAT + '&longitude=' + LON +
      '&current_weather=true&temperature_unit=fahrenheit&timezone=' + encodeURIComponent(TZ);
    fetch(url, {cache: 'no-store', mode: 'cors'})
      .then(function(r) { return r.json(); })
      .then(function(data) {
        var t = Math.round((data && data.current_weather && data.current_weather.temperature) || NaN);
        if (isFinite(t)) { tempEl.textContent = t + '°F'; return; }
        var url2 = 'https://api.open-meteo.com/v1/forecast?latitude=' + LAT + '&longitude=' + LON +
          '&current=temperature_2m&temperature_unit=fahrenheit&timezone=' + encodeURIComponent(TZ);
        return fetch(url2, {cache: 'no-store', mode: 'cors'})
          .then(function(r) { return r.json(); })
          .then(function(d) {
            var t2 = Math.round((d && d.current && d.current.temperature_2m) || NaN);
            tempEl.textContent = (isFinite(t2) ? t2 + '°F' : '--°F');
          });
      })
      .catch(function() { if (tempEl) tempEl.textContent = '--°F'; });
  }
  updateWeather();
  setInterval(updateWeather, 600000);

  var SPOTIFY_CLIENT_ID = 'YOUR_SPOTIFY_CLIENT_ID';
  var SPOTIFY_SCOPES = 'user-read-currently-playing user-read-playback-state';
  var SPOTIFY_AUTHORIZE_URL = 'https://accounts.spotify.com/authorize';
  var SPOTIFY_TOKEN_URL = 'https://accounts.spotify.com/api/token';
  var SPOTIFY_NOW_PLAYING_URL = 'https://api.spotify.com/v1/me/player/currently-playing';
  var spotifyStateKey = 'spotify_oauth_state';
  var spotifyVerifierKey = 'spotify_code_verifier';
  var spotifyTokenKey = 'spotify_token_payload';
  var spotifyConnectBtn = document.getElementById('spotifyConnectBtn');
  var spotifyNowPlayingEl = document.getElementById('spotifyNowPlaying');
  var spotifyPollHandle = null;

  function setSpotifyStatus(message, isError) {
    if (!spotifyNowPlayingEl) return;
    spotifyNowPlayingEl.textContent = message;
    spotifyNowPlayingEl.classList.toggle('is-error', !!isError);
  }

  function spotifyRedirectUri() {
    return window.location.origin + window.location.pathname;
  }

  function randomString(length) {
    var chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
    var values = new Uint8Array(length);
    var result = '';
    window.crypto.getRandomValues(values);
    for (var i = 0; i < values.length; i += 1) {
      result += chars[values[i] % chars.length];
    }
    return result;
  }

  function toBase64Url(arrayBuffer) {
    var bytes = new Uint8Array(arrayBuffer);
    var binary = '';
    for (var i = 0; i < bytes.length; i += 1) {
      binary += String.fromCharCode(bytes[i]);
    }
    return window.btoa(binary).replace(/\+/g, '-').replace(/\//g, '_').replace(/=+$/, '');
  }

  function readSpotifyToken() {
    try {
      var tokenRaw = localStorage.getItem(spotifyTokenKey);
      return tokenRaw ? JSON.parse(tokenRaw) : null;
    } catch (_err) {
      return null;
    }
  }

  function saveSpotifyToken(payload, fallbackRefreshToken) {
    if (!payload || !payload.access_token) return null;
    var expiresIn = Number(payload.expires_in || 3600);
    var tokenData = {
      access_token: payload.access_token,
      refresh_token: payload.refresh_token || fallbackRefreshToken || null,
      expires_at: Date.now() + Math.max((expiresIn - 45) * 1000, 1000),
    };
    localStorage.setItem(spotifyTokenKey, JSON.stringify(tokenData));
    return tokenData;
  }

  function clearSpotifyToken() {
    localStorage.removeItem(spotifyTokenKey);
    localStorage.removeItem(spotifyStateKey);
    localStorage.removeItem(spotifyVerifierKey);
  }

  function updateSpotifyButton() {
    if (!spotifyConnectBtn) return;
    spotifyConnectBtn.textContent = readSpotifyToken() ? 'Disconnect' : 'Connect';
  }

  function getOAuthCallbackValues() {
    var params = new URLSearchParams(window.location.search);
    return {
      code: params.get('code'),
      state: params.get('state'),
      error: params.get('error'),
    };
  }

  async function createCodeChallenge(verifier) {
    var input = new TextEncoder().encode(verifier);
    var digest = await window.crypto.subtle.digest('SHA-256', input);
    return toBase64Url(digest);
  }

  async function beginSpotifyAuth() {
    if (SPOTIFY_CLIENT_ID === 'YOUR_SPOTIFY_CLIENT_ID') {
      setSpotifyStatus('Set your Spotify Client ID in index.html first.', true);
      return;
    }
    var state = randomString(16);
    var verifier = randomString(64);
    var challenge = await createCodeChallenge(verifier);
    localStorage.setItem(spotifyStateKey, state);
    localStorage.setItem(spotifyVerifierKey, verifier);

    var params = new URLSearchParams({
      client_id: SPOTIFY_CLIENT_ID,
      response_type: 'code',
      redirect_uri: spotifyRedirectUri(),
      scope: SPOTIFY_SCOPES,
      state: state,
      code_challenge_method: 'S256',
      code_challenge: challenge,
      show_dialog: 'false',
    });
    window.location.assign(SPOTIFY_AUTHORIZE_URL + '?' + params.toString());
  }

  async function exchangeCodeForToken(code, verifier) {
    var payload = new URLSearchParams({
      client_id: SPOTIFY_CLIENT_ID,
      grant_type: 'authorization_code',
      code: code,
      redirect_uri: spotifyRedirectUri(),
      code_verifier: verifier,
    });
    var resp = await fetch(SPOTIFY_TOKEN_URL, {
      method: 'POST',
      headers: {'Content-Type': 'application/x-www-form-urlencoded'},
      body: payload.toString(),
    });
    if (!resp.ok) {
      throw new Error('Token exchange failed (' + resp.status + ').');
    }
    var data = await resp.json();
    return saveSpotifyToken(data);
  }

  async function refreshSpotifyToken(tokenData) {
    if (!tokenData || !tokenData.refresh_token) {
      throw new Error('Missing refresh token.');
    }
    var payload = new URLSearchParams({
      client_id: SPOTIFY_CLIENT_ID,
      grant_type: 'refresh_token',
      refresh_token: tokenData.refresh_token,
    });
    var resp = await fetch(SPOTIFY_TOKEN_URL, {
      method: 'POST',
      headers: {'Content-Type': 'application/x-www-form-urlencoded'},
      body: payload.toString(),
    });
    if (!resp.ok) {
      throw new Error('Token refresh failed (' + resp.status + ').');
    }
    var data = await resp.json();
    return saveSpotifyToken(data, tokenData.refresh_token);
  }

  async function withValidAccessToken() {
    var tokenData = readSpotifyToken();
    if (!tokenData || !tokenData.access_token) return null;
    if (Date.now() < Number(tokenData.expires_at || 0)) return tokenData.access_token;
    var refreshed = await refreshSpotifyToken(tokenData);
    return refreshed ? refreshed.access_token : null;
  }

  async function handleSpotifyOAuthCallback() {
    var callback = getOAuthCallbackValues();
    if (!callback.code && !callback.error) return;

    var cleanUrl = window.location.pathname + window.location.hash;
    window.history.replaceState({}, document.title, cleanUrl);

    if (callback.error) {
      clearSpotifyToken();
      setSpotifyStatus('Spotify permission denied or canceled.', true);
      return;
    }

    var expectedState = localStorage.getItem(spotifyStateKey);
    var verifier = localStorage.getItem(spotifyVerifierKey);
    localStorage.removeItem(spotifyStateKey);
    localStorage.removeItem(spotifyVerifierKey);
    if (!expectedState || !verifier || callback.state !== expectedState) {
      clearSpotifyToken();
      setSpotifyStatus('Spotify auth failed. Please reconnect.', true);
      return;
    }

    try {
      await exchangeCodeForToken(callback.code, verifier);
      setSpotifyStatus('Connected. Checking now playing...', false);
    } catch (err) {
      clearSpotifyToken();
      setSpotifyStatus((err && err.message) || 'Spotify token exchange failed.', true);
    }
  }

  async function refreshNowPlaying() {
    if (SPOTIFY_CLIENT_ID === 'YOUR_SPOTIFY_CLIENT_ID') {
      setSpotifyStatus('Set client ID in index.html to enable Spotify.', true);
      return;
    }

    var accessToken;
    try {
      accessToken = await withValidAccessToken();
    } catch (_err) {
      clearSpotifyToken();
      updateSpotifyButton();
      setSpotifyStatus('Session expired. Reconnect Spotify.', true);
      return;
    }

    if (!accessToken) {
      setSpotifyStatus('Connect Spotify to show now playing.', false);
      return;
    }

    var resp = await fetch(SPOTIFY_NOW_PLAYING_URL, {
      headers: {Authorization: 'Bearer ' + accessToken},
      cache: 'no-store',
    });

    if (resp.status === 204) {
      setSpotifyStatus('Nothing is playing right now.', false);
      return;
    }

    if (resp.status === 401) {
      try {
        var refreshedToken = await refreshSpotifyToken(readSpotifyToken());
        accessToken = refreshedToken && refreshedToken.access_token;
      } catch (_err2) {
        clearSpotifyToken();
        updateSpotifyButton();
        setSpotifyStatus('Session expired. Reconnect Spotify.', true);
        return;
      }
      resp = await fetch(SPOTIFY_NOW_PLAYING_URL, {
        headers: {Authorization: 'Bearer ' + accessToken},
        cache: 'no-store',
      });
    }

    if (!resp.ok) {
      setSpotifyStatus('Unable to read playback right now (' + resp.status + ').', true);
      return;
    }

    var data = await resp.json();
    var item = data && data.item;
    if (!item) {
      setSpotifyStatus('Nothing is playing right now.', false);
      return;
    }
    var artists = (item.artists || []).map(function(a) { return a.name; }).join(', ');
    var state = data.is_playing ? 'Playing' : 'Paused';
    setSpotifyStatus(state + ': ' + item.name + (artists ? ' - ' + artists : ''), false);
  }

  if (spotifyConnectBtn) {
    spotifyConnectBtn.addEventListener('click', function() {
      if (readSpotifyToken()) {
        clearSpotifyToken();
        updateSpotifyButton();
        setSpotifyStatus('Disconnected from Spotify.', false);
        if (spotifyPollHandle) clearInterval(spotifyPollHandle);
        return;
      }
      beginSpotifyAuth();
    });
  }

  updateSpotifyButton();
  handleSpotifyOAuthCallback()
    .catch(function() {
      setSpotifyStatus('Could not complete Spotify login.', true);
    })
    .finally(function() {
      updateSpotifyButton();
      refreshNowPlaying();
      if (spotifyPollHandle) clearInterval(spotifyPollHandle);
      spotifyPollHandle = setInterval(refreshNowPlaying, 30000);
    });
});
var scroller = document.getElementById('scroller');
var sections = Array.prototype.slice.call(document.querySelectorAll('section.panel'));
var dots = Array.prototype.slice.call(document.querySelectorAll('.left-dots button'));
var tabLinks = Array.prototype.slice.call(document.querySelectorAll('.tabs a[data-section]'));
function setActive(id) {
  dots.forEach(function(d) { d.setAttribute('aria-current', String(d.getAttribute('data-target') === '#' + id)); });
  tabLinks.forEach(function(a) { a.classList.toggle('active', a.getAttribute('data-section') === id); });
}
dots.forEach(function(btn) {
  btn.addEventListener('click', function() {
    var el = document.querySelector(btn.getAttribute('data-target'));
    if (el) el.scrollIntoView({behavior: 'smooth', block: 'start'});
  });
});
tabLinks.forEach(function(a) {
  a.addEventListener('click', function(e) {
    e.preventDefault();
    var el = document.getElementById(a.getAttribute('data-section'));
    if (el) el.scrollIntoView({behavior: 'smooth', block: 'start'});
  });
});
var io = new IntersectionObserver(function(entries) {
  entries.forEach(function(entry) { if (entry.isIntersecting) setActive(entry.target.id); });
}, {root: scroller, threshold: 0.5});
sections.forEach(function(s) { io.observe(s); });
function goto(idx) {
  var i = Math.max(0, Math.min(idx, sections.length - 1));
  sections[i].scrollIntoView({behavior: 'smooth', block: 'start'});
}
document.addEventListener('keydown', function(e) {
  if (['ArrowDown', 'PageDown', ' '].indexOf(e.key) >= 0) {
    e.preventDefault();
    var cur = sections.findIndex(function(s) {
      var r = s.getBoundingClientRect();
      return r.top >= -10 && r.top < window.innerHeight * 0.5;
    });
    goto((cur === -1 ? 0 : cur) + 1);
  } else if (['ArrowUp', 'PageUp'].indexOf(e.key) >= 0) {
    e.preventDefault();
    var cur2 = sections.findIndex(function(s) {
      var r = s.getBoundingClientRect();
      return r.top >= -10 && r.top < window.innerHeight * 0.5;
    });
    goto((cur2 === -1 ? 0 : cur2) - 1);
  }
});
if (matchMedia('(pointer:fine)').matches) {
  var dot = document.getElementById('cDot');
  var ring = document.getElementById('cRing');
  var cx = window.innerWidth / 2, cy = window.innerHeight / 2, rx = cx, ry = cy;
  function lerp(a, b, n) { return (1 - n) * a + n * b; }
  window.addEventListener('mousemove', function(e) {
    cx = e.clientX; cy = e.clientY;
    dot.style.transform = 'translate(' + (cx - 3) + 'px,' + (cy - 3) + 'px)';
  }, {passive: true});
  (function loop() {
    rx = lerp(rx, cx, .18); ry = lerp(ry, cy, .18);
    var rw = ring.offsetWidth / 2;
    ring.style.transform = 'translate(' + (rx - rw) + 'px,' + (ry - rw) + 'px)';
    requestAnimationFrame(loop);
  })();
  var hov = 'a,button,[role="button"],.hoverable,input,textarea,select';
  document.addEventListener('mouseover', function(e) { if (e.target.closest(hov)) ring.classList.add('-hover'); });
  document.addEventListener('mouseout', function(e) { if (e.target.closest(hov)) ring.classList.remove('-hover'); });
  document.addEventListener('mouseleave', function() { ring.style.opacity = '.35'; });
  document.addEventListener('mouseenter', function() { ring.style.opacity = '.75'; });
}
(function() {
  var items = document.querySelectorAll('#timeline li');
  if (!items.length) return;
  var obs = new IntersectionObserver(function(entries) {
    entries.forEach(function(e) { if (e.isIntersecting) e.target.classList.add('in-view'); });
  }, {root: scroller || null, threshold: 0.25});
  items.forEach(function(li) { obs.observe(li); });
})();
document.querySelectorAll('#s2 .tl-card').forEach(function(card) {
  card.addEventListener('click', function(e) {
    e.preventDefault();
    card.classList.toggle('is-expanded');
    card.setAttribute('aria-expanded', card.classList.contains('is-expanded'));
  });
  card.addEventListener('keydown', function(e) {
    if (e.key === 'Enter' || e.key === ' ') {
      e.preventDefault();
      card.classList.toggle('is-expanded');
      card.setAttribute('aria-expanded', card.classList.contains('is-expanded'));
    }
  });
});
</script>
</body>
</html>
